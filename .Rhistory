modelName = "Resource Users")
m1_1Frame = data.frame(Variable = rownames(summary(m1_1)$coef)[2:4],
Coefficient = summary(m1_1)$coef[2:4, 1],
SE = summary(m1_1)$coef[2:4, 2],
modelName = "Mass Public")
allModelFrame = data.frame(rbind(m2_1Frame,m3_1Frame,m1_1Frame))
allModelFrame$Variable =  revalue(allModelFrame$Variable, c("organization_var2"="ENV","frame_var2"="Sustainable use frame", "frame_var3"="Pandemic frame"))
# Specify the width of your confidence intervals
interval1 = -qnorm((1-0.9)/2)  # 90% multiplier
interval2 = -qnorm((1-0.95)/2)  # 95% multiplier
# Plot
allModelFrame$Variable = factor(allModelFrame$Variable, levels = c("ENV","Sustainable use frame","Pandemic frame"), order =TRUE)
zp1 = ggplot(allModelFrame, aes(colour = modelName))
zp1 = zp1 + geom_hline(yintercept = 0, colour = gray(1/2), lty = 2)
zp1 = zp1 + geom_linerange(aes(x = Variable,
ymin = Coefficient - SE*interval1,
ymax = Coefficient + SE*interval1),
lwd = 1,
position = position_dodge(width = 1/2))
zp1 = zp1 + geom_pointrange(aes(x = Variable, y = Coefficient,
ymin = Coefficient - SE*interval2,
ymax = Coefficient + SE*interval2),
lwd = 1/2,
position = position_dodge(width = 1/2),
shape = 16)
zp1 = zp1 + theme_bw() + scale_colour_grey(start = .1, end = .6, name = "Group", labels = c("Preservationists","Resource Users","Mass Public")) + theme(axis.text.x = element_text(angle = 45,  vjust = 1, hjust=1))
print(zp1)
m1_1 = lm(Q17~organization_var+frame_var+age+Q2+ relevel(factor(Q6), ref="Less than high school degree") + relevel(Q8, ref="Not proud at all") + relevel(Q10, ref="Urban")+relevel(Q12, ref="Urban") + relevel(Q14, ref="Neither"),weights = weight, mass)
m1_1 = lm(Q17~organization_var+frame_var+age+Q2+ relevel(factor(Q6), ref="Less than high school degree") + relevel(factor(Q8), ref="Not proud at all") + relevel(factor(Q10), ref="Urban")+relevel(factor(Q12), ref="Urban") + relevel(factor(Q14), ref="Neither"),weights = weight, mass)
m1_2 = lm(Q17~frame_var+organization_var, weights = weight,mass)
summary(m1_1)
library(ggplot2)
library(plyr)
library(reshape)
library(weights)
rm(list=ls())
d = read.csv("clean_data.csv", header = T)
d$frame_var = as.factor(d$frame_var)# 1=harm-and-threats, 2=sustainability, 3=pandemic frame
d$organization_var = as.factor(d$organization_var)# 1=WWF, 2=ENV (Vietnam)
### Subgroup
# Resource Users (earlier version of the paper used the term "appropriators")
appropriators = rbind(d[which(d$Q34=="A few times a week"),], d[which(d$Q34=="Everyday"),])
# Preservationists
preservationists = d[which(d$Q28=="Very important"&d$Q30=="Very important"&d$Q34!="A few times a week"&d$Q34!="Everyday"),]
# Mass Public
x=c(appropriators$id,preservationists$id)
x=(unique(x))
mass = d
for (i in 1:length(x)) {
mass = mass[-which(mass$id==x[i]),]
}
### Regression models
m1_1 = lm(Q17~organization_var+frame_var+age+Q2+ relevel(factor(Q6), ref="Less than high school degree") + relevel(factor(Q8), ref="Not proud at all") + relevel(factor(Q10), ref="Urban")+relevel(factor(Q12), ref="Urban") + relevel(factor(Q14), ref="Neither"),weights = weight, mass)
m1_2 = lm(Q17~frame_var+organization_var, weights = weight,mass)
m2_1 = lm(Q17~organization_var+frame_var+age+Q2+ relevel(factor(Q6), ref="Less than high school degree") + relevel(factor(Q8), ref="Not proud at all") + relevel(factor(Q10), ref="Urban")+relevel(factor(Q12), ref="Urban") + relevel(factor(Q14), ref="Neither"),weights = weight, preservationists)
m2_2 = lm(Q17~frame_var+organization_var, weights = weight, preservationists)
m3_1 = lm(Q17~organization_var+frame_var+age+Q2+ relevel(factor(Q6), ref="Less than high school degree") + relevel(factor(Q8), ref="Not proud at all") + relevel(factor(Q10), ref="Urban")+relevel(factor(Q12), ref="Urban") + relevel(factor(Q14), ref="Neither"),weights = weight, appropriators)
m3_2 = lm(Q17~frame_var+organization_var, weights = weight, appropriators)
### Visualization
m2_1Frame = data.frame(Variable = rownames(summary(m2_1)$coef)[2:4],
Coefficient = summary(m2_1)$coef[2:4, 1],
SE = summary(m2_1)$coef[2:4, 2],
modelName = "Preservationists")
m3_1Frame = data.frame(Variable = rownames(summary(m3_1)$coef)[2:4],
Coefficient = summary(m3_1)$coef[2:4, 1],
SE = summary(m3_1)$coef[2:4, 2],
modelName = "Resource Users")
m1_1Frame = data.frame(Variable = rownames(summary(m1_1)$coef)[2:4],
Coefficient = summary(m1_1)$coef[2:4, 1],
SE = summary(m1_1)$coef[2:4, 2],
modelName = "Mass Public")
allModelFrame = data.frame(rbind(m2_1Frame,m3_1Frame,m1_1Frame))
allModelFrame$Variable =  revalue(allModelFrame$Variable, c("organization_var2"="ENV","frame_var2"="Sustainable use frame", "frame_var3"="Pandemic frame"))
# Specify the width of your confidence intervals
interval1 = -qnorm((1-0.9)/2)  # 90% multiplier
interval2 = -qnorm((1-0.95)/2)  # 95% multiplier
# Plot
allModelFrame$Variable = factor(allModelFrame$Variable, levels = c("ENV","Sustainable use frame","Pandemic frame"), order =TRUE)
zp1 = ggplot(allModelFrame, aes(colour = modelName))
zp1 = zp1 + geom_hline(yintercept = 0, colour = gray(1/2), lty = 2)
zp1 = zp1 + geom_linerange(aes(x = Variable,
ymin = Coefficient - SE*interval1,
ymax = Coefficient + SE*interval1),
lwd = 1,
position = position_dodge(width = 1/2))
zp1 = zp1 + geom_pointrange(aes(x = Variable, y = Coefficient,
ymin = Coefficient - SE*interval2,
ymax = Coefficient + SE*interval2),
lwd = 1/2,
position = position_dodge(width = 1/2),
shape = 16)
zp1 = zp1 + theme_bw() + scale_colour_grey(start = .1, end = .6, name = "Group", labels = c("Preservationists","Resource Users","Mass Public")) + theme(axis.text.x = element_text(angle = 45,  vjust = 1, hjust=1))
print(zp1)
View(appropriators)
library(ggplot2)
library(plyr)
library(reshape)
library(weights)
##### Preparation #####
setwd("/Users/Takumi Shibaike/OneDrive - Syracuse University/Desktop/experiment/data")
rm(list=ls())
d = read.csv("clean_data.csv", header = T)
d$frame_var = as.factor(d$frame_var)# 1=harm-and-threats, 2=sustainability, 3=pandemic frame
d$organization_var = as.factor(d$organization_var)# 1=WWF, 2=ENV (Vietnam)
#d$Q6 =  factor(d$Q6, levels = c("Less than high school degree","High school degree","University degree", "Post-graduate degree"), order =TRUE)
#length(which(d$organization_var==1))
#weighted.mean(appropriators$Q17[which(appropriators$frame_var==3)],appropriators$weight[which(appropriators$frame_var==3)], na.rm = T)
weighted.mean(d$Q17,d$weight, na.rm = T)
length(which(d$Q21=="No, I will let them decide what to do."))/length(d$Q21)
appropriators = rbind(d[which(d$Q34=="A few times a week"),], d[which(d$Q34=="Everyday"),])
preservationists = d[which(d$Q28=="Very important"&d$Q30=="Very important"&d$Q34!="A few times a week"&d$Q34!="Everyday"),]
#preservationists = d[which(d$Q28=="Very important"&d$Q30=="Very important"),]  # When overlapping resource users are not removed
x=c(appropriators$id,preservationists$id)
x=(unique(x))
mass = d
for (i in 1:length(x)) {
mass = mass[-which(mass$id==x[i]),]
}
##### Descriptive #####
d = preservationists
#d$Q2 =  as.numeric(as.character(revalue(d$Q2, c("Female"=1, "Male"=0  ,"Other"=0))))
#d$Q6 =  as.numeric(as.character(revalue(d$Q6, c("University degree"=3, "Post-graduate degree"=4,"High school degree"=2, "Less than high school degree"=1))))
#d$Q8 =  as.numeric(as.character(revalue(d$Q8, c("Very proud"=1, "Somewhat proud"=1,"Not very proud"=0, "Not proud at all"=0,"I am not Vietnamese"=0))))
#d$Q10 =  as.numeric(as.character(revalue(d$Q10, c("Urban"=1, "Rural"=0))))
#d$Q12 =  as.numeric(as.character(revalue(d$Q12, c("Urban"=1, "Rural"=0,"Both"=0))))
#d$Q14 =  as.numeric(as.character(revalue(d$Q14, c("Northern Vietnam"=1, "Southern Vietnam"=0,"Both equally"=0, "Neither"=0))))
mean(d$Q2, na.rm = T)*100
mean(d$age, na.rm = T)
mean(d$Q6, na.rm = T)*100
mean(d$Q8, na.rm = T)*100
mean(d$Q10, na.rm = T)*100
mean(d$Q12, na.rm = T)*100
mean(d$Q14, na.rm = T)*100
###### Regression #####
m = lm(Q17~organization_var+frame_var+age+Q2+ relevel(Q6, ref="Less than high school degree") + relevel(Q8, ref="Not proud at all") + relevel(Q10, ref="Urban")+relevel(Q12, ref="Urban") + relevel(Q14, ref="Neither"),weights = weight, d)
summary(m)
m1_1 = lm(Q17~organization_var+frame_var+age+Q2+ relevel(Q6, ref="Less than high school degree") + relevel(Q8, ref="Not proud at all") + relevel(Q10, ref="Urban")+relevel(Q12, ref="Urban") + relevel(Q14, ref="Neither"),weights = weight, mass)
m1_2 = lm(Q17~frame_var+organization_var, weights = weight,mass)
m2_1 = lm(Q17~organization_var+frame_var+age+Q2+ relevel(Q6, ref="Less than high school degree") + relevel(Q8, ref="Not proud at all") + relevel(Q10, ref="Urban")+relevel(Q12, ref="Urban") + relevel(Q14, ref="Neither"), weights = weight, preservationists)
m2_2 = lm(Q17~frame_var+organization_var, weights = weight, preservationists)
m3_1 = lm(Q17~organization_var+frame_var+age+Q2+ relevel(Q6, ref="Less than high school degree") + relevel(Q8, ref="Not proud at all") + relevel(Q10, ref="Urban")+relevel(Q12, ref="Urban") + relevel(Q14, ref="Neither"), weights = weight, appropriators)
m3_2 = lm(Q17~frame_var+organization_var, weights = weight, appropriators)
#stargazer::stargazer(m1_1,m1_2, m2_1, m2_2, m3_1, m3_2, star.cutoffs = c(.05, .01, .001))
#stargazer::stargazer(m2_1, m2_2, star.cutoffs = c(.05, .01, .001))
##### Visualization #####
# Q17 (should not buy pangolins) and Q24 (should not shop @ wet market)
### Average response
ggplot(d, aes(x = Q17, weight = weight)) + geom_histogram(bins=7)
sum_d = data.frame()
d = preservationists
for (i in c(1,2,3)) {
x = d[which(d$frame_var==i),]
sum_d = rbind(sum_d,data.frame("mean"=wtd.mean(x$Q17, x$weight),"sd"=sqrt(wtd.var(x$Q17, x$weight)),"se"=sqrt(wtd.var(x$Q17, x$weight))/sqrt(length(x$Q17)),"frame"=i,"type"="pres"))
}
d = appropriators
for (i in c(1,2,3)) {
x = d[which(d$frame_var==i),]
sum_d = rbind(sum_d,data.frame("mean"=wtd.mean(x$Q17, x$weight),"sd"=sqrt(wtd.var(x$Q17, x$weight)),"se"=sqrt(wtd.var(x$Q17, x$weight))/sqrt(length(x$Q17)),"frame"=i,"type"="appr"))
}
d = mass
for (i in c(1,2,3)) {
x = d[which(d$frame_var==i),]
sum_d = rbind(sum_d,data.frame("mean"=wtd.mean(x$Q17, x$weight),"sd"=sqrt(wtd.var(x$Q17, x$weight)),"se"=sqrt(wtd.var(x$Q17, x$weight))/sqrt(length(x$Q17)),"frame"=i,"type"="mass"))
}
p= ggplot(sum_d, aes(x=type, y=mean, fill= as.factor(frame) )) +
geom_bar(stat="identity", color="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-1.96*se, ymax=mean+1.96*se), width=.2, position=position_dodge(.9)) +  labs(x = "Respondent Groups") + scale_x_discrete(labels = c("Preservationists","Resource Users","Mass Public")) + coord_cartesian(ylim=c(3,7)) + scale_fill_grey(start = 0.4, end = .9, name = "Frame", labels = c("Harm-and-threats", "Sustainable use","Pandemic"))+  theme_bw()
p
sum_d = data.frame()
d = preservationists
for (i in c(1,2)) {
x = d[which(d$organization_var==i),]
sum_d = rbind(sum_d,data.frame("mean"=wtd.mean(x$Q17, x$weight),"sd"=sqrt(wtd.var(x$Q17, x$weight)),"se"=sqrt(wtd.var(x$Q17, x$weight))/sqrt(length(x$Q17)),"org"=i,"type"="pres"))
}
d = appropriators
for (i in c(1,2)) {
x = d[which(d$organization_var==i),]
sum_d = rbind(sum_d,data.frame("mean"=wtd.mean(x$Q17, x$weight),"sd"=sqrt(wtd.var(x$Q17, x$weight)),"se"=sqrt(wtd.var(x$Q17, x$weight))/sqrt(length(x$Q17)),"org"=i,"type"="appr"))
}
d = mass
for (i in c(1,2)) {
x = d[which(d$organization_var==i),]
sum_d = rbind(sum_d,data.frame("mean"=wtd.mean(x$Q17, x$weight),"sd"=sqrt(wtd.var(x$Q17, x$weight)),"se"=sqrt(wtd.var(x$Q17, x$weight))/sqrt(length(x$Q17)),"org"=i,"type"="mass"))
}
p= ggplot(sum_d, aes(x=type, y=mean, fill=factor(sum_d$org))) +
geom_bar(stat="identity", color="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-1.96*se, ymax=mean+1.96*se), width=.2, position=position_dodge(.9)) +  labs(x = "Respondent Groups") + scale_x_discrete(labels = c("Preservationists","Resource Users","Mass Public"))+ coord_cartesian(ylim=c(3,7)) + scale_fill_grey(start = 0.4, end = .9, name = "NGO", labels = c("WWF", "ENV"))+  theme_bw()
p
### Coefficient plot
m2_1Frame = data.frame(Variable = rownames(summary(m2_1)$coef)[2:4],
Coefficient = summary(m2_1)$coef[2:4, 1],
SE = summary(m2_1)$coef[2:4, 2],
modelName = "Preservationists")
m3_1Frame = data.frame(Variable = rownames(summary(m3_1)$coef)[2:4],
Coefficient = summary(m3_1)$coef[2:4, 1],
SE = summary(m3_1)$coef[2:4, 2],
modelName = "Resource Users")
m1_1Frame = data.frame(Variable = rownames(summary(m1_1)$coef)[2:4],
Coefficient = summary(m1_1)$coef[2:4, 1],
SE = summary(m1_1)$coef[2:4, 2],
modelName = "Mass Public")
allModelFrame = data.frame(rbind(m2_1Frame,m3_1Frame,m1_1Frame))
allModelFrame$Variable =  revalue(allModelFrame$Variable, c("organization_var2"="ENV","frame_var2"="Sustainable use frame", "frame_var3"="Pandemic frame"))
# Specify the width of your confidence intervals
interval1 = -qnorm((1-0.9)/2)  # 90% multiplier
interval2 = -qnorm((1-0.95)/2)  # 95% multiplier
# Plot
allModelFrame$Variable = factor(allModelFrame$Variable, levels = c("ENV","Sustainable use frame","Pandemic frame"), order =TRUE)
zp1 = ggplot(allModelFrame, aes(colour = modelName))
zp1 = zp1 + geom_hline(yintercept = 0, colour = gray(1/2), lty = 2)
zp1 = zp1 + geom_linerange(aes(x = Variable,
ymin = Coefficient - SE*interval1,
ymax = Coefficient + SE*interval1),
lwd = 1,
position = position_dodge(width = 1/2))
zp1 = zp1 + geom_pointrange(aes(x = Variable, y = Coefficient,
ymin = Coefficient - SE*interval2,
ymax = Coefficient + SE*interval2),
lwd = 1/2,
position = position_dodge(width = 1/2),
shape = 16)
zp1 = zp1 + theme_bw() + scale_colour_grey(start = .1, end = .6, name = "Group", labels = c("Preservationists","Resource Users","Mass Public")) + theme(axis.text.x = element_text(angle = 45,  vjust = 1, hjust=1))
print(zp1)
##### WWF vs ENV #####
library(tidyr)
trend = read.csv("wwf_env.csv", header = T)
colnames(trend)[1:3] = c("week","ENV","WWF")
trend[,1] = as.Date(trend[,1])
trend = gather(trend, key="variable", value = value, -week)
colnames(trend)[2]="NGO"
ggplot(data=trend, aes(x=week, y=value)) +
geom_line(aes(linetype=NGO)) + labs(x = "Year", y = "Weekly Google Trend", fill = "NGO") + theme_bw()
library(ggplot2)
library(plyr)
library(reshape)
library(weights)
rm(list=ls())
d = read.csv("clean_data.csv", header = T)
d$frame_var = as.factor(d$frame_var)# 1=harm-and-threats, 2=sustainability, 3=pandemic frame
d$organization_var = as.factor(d$organization_var)# 1=WWF, 2=ENV (Vietnam)
### Subgroup
# Resource Users (earlier version of the paper used the term "appropriators")
appropriators = rbind(d[which(d$Q34=="A few times a week"),], d[which(d$Q34=="Everyday"),])
# Preservationists
preservationists = d[which(d$Q28=="Very important"&d$Q30=="Very important"&d$Q34!="A few times a week"&d$Q34!="Everyday"),]
# Mass Public
x=c(appropriators$id,preservationists$id)
x=(unique(x))
mass = d
for (i in 1:length(x)) {
mass = mass[-which(mass$id==x[i]),]
}
### Regression models
m1_1 = lm(Q17~organization_var+frame_var+age+Q2+ relevel(factor(Q6), ref="Less than high school degree") + relevel(factor(Q8), ref="Not proud at all") + relevel(factor(Q10), ref="Urban")+relevel(factor(Q12), ref="Urban") + relevel(factor(Q14), ref="Neither"),weights = weight, mass)
m1_2 = lm(Q17~frame_var+organization_var, weights = weight,mass)
m2_1 = lm(Q17~organization_var+frame_var+age+Q2+ relevel(Q6, ref="Less than high school degree") + relevel(Q8, ref="Not proud at all") + relevel(Q10, ref="Urban")+relevel(Q12, ref="Urban") + relevel(Q14, ref="Neither"), weights = weight, preservationists)
m2_2 = lm(Q17~frame_var+organization_var, weights = weight, preservationists)
m3_1 = lm(Q17~organization_var+frame_var+age+Q2+ relevel(Q6, ref="Less than high school degree") + relevel(Q8, ref="Not proud at all") + relevel(Q10, ref="Urban")+relevel(Q12, ref="Urban") + relevel(Q14, ref="Neither"), weights = weight, appropriators)
m3_2 = lm(Q17~frame_var+organization_var, weights = weight, appropriators)
### Visualization
m2_1Frame = data.frame(Variable = rownames(summary(m2_1)$coef)[2:4],
Coefficient = summary(m2_1)$coef[2:4, 1],
SE = summary(m2_1)$coef[2:4, 2],
modelName = "Preservationists")
m3_1Frame = data.frame(Variable = rownames(summary(m3_1)$coef)[2:4],
Coefficient = summary(m3_1)$coef[2:4, 1],
SE = summary(m3_1)$coef[2:4, 2],
modelName = "Resource Users")
m1_1Frame = data.frame(Variable = rownames(summary(m1_1)$coef)[2:4],
Coefficient = summary(m1_1)$coef[2:4, 1],
SE = summary(m1_1)$coef[2:4, 2],
modelName = "Mass Public")
allModelFrame = data.frame(rbind(m2_1Frame,m3_1Frame,m1_1Frame))
allModelFrame$Variable =  revalue(allModelFrame$Variable, c("organization_var2"="ENV","frame_var2"="Sustainable use frame", "frame_var3"="Pandemic frame"))
# Specify the width of your confidence intervals
interval1 = -qnorm((1-0.9)/2)  # 90% multiplier
interval2 = -qnorm((1-0.95)/2)  # 95% multiplier
# Plot
allModelFrame$Variable = factor(allModelFrame$Variable, levels = c("ENV","Sustainable use frame","Pandemic frame"), order =TRUE)
zp1 = ggplot(allModelFrame, aes(colour = modelName))
zp1 = zp1 + geom_hline(yintercept = 0, colour = gray(1/2), lty = 2)
zp1 = zp1 + geom_linerange(aes(x = Variable,
ymin = Coefficient - SE*interval1,
ymax = Coefficient + SE*interval1),
lwd = 1,
position = position_dodge(width = 1/2))
zp1 = zp1 + geom_pointrange(aes(x = Variable, y = Coefficient,
ymin = Coefficient - SE*interval2,
ymax = Coefficient + SE*interval2),
lwd = 1/2,
position = position_dodge(width = 1/2),
shape = 16)
zp1 = zp1 + theme_bw() + scale_colour_grey(start = .1, end = .6, name = "Group", labels = c("Preservationists","Resource Users","Mass Public")) + theme(axis.text.x = element_text(angle = 45,  vjust = 1, hjust=1))
print(zp1)
library(ggplot2)
library(plyr)
library(reshape)
library(weights)
rm(list=ls())
d = read.csv("clean_data.csv", header = T)
d$frame_var = as.factor(d$frame_var)# 1=harm-and-threats, 2=sustainability, 3=pandemic frame
d$organization_var = as.factor(d$organization_var)# 1=WWF, 2=ENV (Vietnam)
### Subgroup
# Resource Users (earlier version of the paper used the term "appropriators")
appropriators = rbind(d[which(d$Q34=="A few times a week"),], d[which(d$Q34=="Everyday"),])
# Preservationists
preservationists = d[which(d$Q28=="Very important"&d$Q30=="Very important"&d$Q34!="A few times a week"&d$Q34!="Everyday"),]
# Mass Public
x=c(appropriators$id,preservationists$id)
x=(unique(x))
mass = d
for (i in 1:length(x)) {
mass = mass[-which(mass$id==x[i]),]
}
### Regression models
m1_1 = lm(Q17~organization_var+frame_var+age+Q2+ relevel(factor(Q6), ref="Less than high school degree") + relevel(factor(Q8), ref="Not proud at all") + relevel(factor(Q10), ref="Urban")+relevel(factor(Q12), ref="Urban") + relevel(factor(Q14), ref="Neither"),weights = weight, mass)
m1_2 = lm(Q17~frame_var+organization_var, weights = weight,mass)
m2_1 = lm(Q17~organization_var+frame_var+age+Q2+ relevel(factor(Q6), ref="Less than high school degree") + relevel(factor(Q8), ref="Not proud at all") + relevel(factor(Q10), ref="Urban")+relevel(factor(Q12), ref="Urban") + relevel(factor(Q14), ref="Neither"),weights = weight, preservationists)
m3_1 = lm(Q17~organization_var+frame_var+age+Q2+ relevel(factor(Q6), ref="Less than high school degree") + relevel(factor(Q8), ref="Not proud at all") + relevel(factor(Q10), ref="Urban")+relevel(factor(Q12), ref="Urban") + relevel(factor(Q14), ref="Neither"),weights = weight, appropriators)
m3_2 = lm(Q17~frame_var+organization_var, weights = weight, appropriators)
View(appropriators)
m1_1 = lm(Q17~organization_var+frame_var+age+Q2+ relevel(factor(Q6), ref="Less than high school degree") + relevel(factor(Q8), ref="Not proud at all") + relevel(factor(Q10), ref="Urban")+relevel(factor(Q12), ref="Urban") + relevel(factor(Q14), ref="Neither"),weights = weight, mass)
m1_2 = lm(Q17~frame_var+organization_var, weights = weight,mass)
m2_1 = lm(Q17~organization_var+frame_var+age+Q2+ relevel(factor(Q6), ref="Less than high school degree") + relevel(factor(Q8), ref="Not proud at all") + relevel(factor(Q10), ref="Urban")+relevel(factor(Q12), ref="Urban") + relevel(factor(Q14), ref="Neither"),weights = weight, preservationists)
m3_1 = lm(Q17~organization_var+frame_var+age+Q2+ relevel(factor(Q6), ref="Less than high school degree") + relevel(factor(Q8), ref="somewhat proud") + relevel(factor(Q10), ref="Urban")+relevel(factor(Q12), ref="Urban") + relevel(factor(Q14), ref="Neither"),weights = weight, appropriators)
m3_2 = lm(Q17~frame_var+organization_var, weights = weight, appropriators)
View(appropriators)
m3_1 = lm(Q17~organization_var+frame_var+age+Q2+ relevel(factor(Q6), ref="Less than high school degree") + relevel(factor(Q8), ref="Somewhat proud") + relevel(factor(Q10), ref="Urban")+relevel(factor(Q12), ref="Urban") + relevel(factor(Q14), ref="Neither"),weights = weight, appropriators)
library(plyr)
library(ggplot2)
library(weights)
rm(list=ls())
d = read.csv("clean_data.csv", header = T) # all
# Resource Users (earlier version of the paper used the term "appropriators")
appropriators = rbind(d[which(d$Q34=="A few times a week"),], d[which(d$Q34=="Everyday"),])
# Preservationists
preservationists = d[which(d$Q28=="Very important"&d$Q30=="Very important"&d$Q34!="A few times a week"&d$Q34!="Everyday"),]
# Mass Public
x=c(appropriators$id,preservationists$id)
x=(unique(x))
mass = d
for (i in 1:length(x)) {
mass = mass[-which(mass$id==x[i]),]
}
sum_d = data.frame()
d = preservationists
for (i in c(1,2)) {
x = d[which(d$organization_var==i),]
sum_d = rbind(sum_d,data.frame("mean"=wtd.mean(x$Q17, x$weight),"sd"=sqrt(wtd.var(x$Q17, x$weight)),"se"=sqrt(wtd.var(x$Q17, x$weight))/sqrt(length(x$Q17)),"org"=i,"type"="pres"))
}
d = appropriators
for (i in c(1,2)) {
x = d[which(d$organization_var==i),]
sum_d = rbind(sum_d,data.frame("mean"=wtd.mean(x$Q17, x$weight),"sd"=sqrt(wtd.var(x$Q17, x$weight)),"se"=sqrt(wtd.var(x$Q17, x$weight))/sqrt(length(x$Q17)),"org"=i,"type"="appr"))
}
d = mass
for (i in c(1,2)) {
x = d[which(d$organization_var==i),]
sum_d = rbind(sum_d,data.frame("mean"=wtd.mean(x$Q17, x$weight),"sd"=sqrt(wtd.var(x$Q17, x$weight)),"se"=sqrt(wtd.var(x$Q17, x$weight))/sqrt(length(x$Q17)),"org"=i,"type"="mass"))
}
p= ggplot(sum_d, aes(x=type, y=mean, fill=factor(sum_d$org))) +
geom_bar(stat="identity", color="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-1.96*se, ymax=mean+1.96*se), width=.2, position=position_dodge(.9)) +  labs(x = "Respondent Groups") + scale_x_discrete(labels = c("Preservationists","Resource Users","Mass Public"))+ coord_cartesian(ylim=c(3,7)) + scale_fill_grey(start = 0.4, end = .9, name = "NGO", labels = c("WWF", "ENV"))+  theme_bw()
p
sum_d = data.frame()
d = preservationists
for (i in c(1,2,3)) {
x = d[which(d$frame_var==i),]
sum_d = rbind(sum_d,data.frame("mean"=wtd.mean(x$Q17, x$weight),"sd"=sqrt(wtd.var(x$Q17, x$weight)),"se"=sqrt(wtd.var(x$Q17, x$weight))/sqrt(length(x$Q17)),"frame"=i,"type"="pres"))
}
d = appropriators
for (i in c(1,2,3)) {
x = d[which(d$frame_var==i),]
sum_d = rbind(sum_d,data.frame("mean"=wtd.mean(x$Q17, x$weight),"sd"=sqrt(wtd.var(x$Q17, x$weight)),"se"=sqrt(wtd.var(x$Q17, x$weight))/sqrt(length(x$Q17)),"frame"=i,"type"="appr"))
}
d = mass
for (i in c(1,2,3)) {
x = d[which(d$frame_var==i),]
sum_d = rbind(sum_d,data.frame("mean"=wtd.mean(x$Q17, x$weight),"sd"=sqrt(wtd.var(x$Q17, x$weight)),"se"=sqrt(wtd.var(x$Q17, x$weight))/sqrt(length(x$Q17)),"frame"=i,"type"="mass"))
}
p= ggplot(sum_d, aes(x=type, y=mean, fill= as.factor(frame) )) +
geom_bar(stat="identity", color="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-1.96*se, ymax=mean+1.96*se), width=.2, position=position_dodge(.9)) +  labs(x = "Respondent Groups") + scale_x_discrete(labels = c("Preservationists","Resource Users","Mass Public")) + coord_cartesian(ylim=c(3,7)) + scale_fill_grey(start = 0.4, end = .9, name = "Frame", labels = c("Harm-and-threats", "Sustainable use","Pandemic"))+  theme_bw()
p
library(plyr)
library(ggplot2)
library(weights)
rm(list=ls())
d = read.csv("clean_data.csv", header = T) # all
### Subgroup
# Resource Users (earlier version of the paper used the term "appropriators")
appropriators = rbind(d[which(d$Q34=="A few times a week"),], d[which(d$Q34=="Everyday"),])
# Preservationists
preservationists = d[which(d$Q28=="Very important"&d$Q30=="Very important"&d$Q34!="A few times a week"&d$Q34!="Everyday"),]
# Mass Public
x=c(appropriators$id,preservationists$id)
x=(unique(x))
mass = d
for (i in 1:length(x)) {
mass = mass[-which(mass$id==x[i]),]
}
##### Average responses
### Figure 2 (a): average responses based on information sources
sum_d = data.frame()
d = preservationists
for (i in c(1,2)) {
x = d[which(d$organization_var==i),]
sum_d = rbind(sum_d,data.frame("mean"=wtd.mean(x$Q17, x$weight),"sd"=sqrt(wtd.var(x$Q17, x$weight)),"se"=sqrt(wtd.var(x$Q17, x$weight))/sqrt(length(x$Q17)),"org"=i,"type"="pres"))
}
d = appropriators
for (i in c(1,2)) {
x = d[which(d$organization_var==i),]
sum_d = rbind(sum_d,data.frame("mean"=wtd.mean(x$Q17, x$weight),"sd"=sqrt(wtd.var(x$Q17, x$weight)),"se"=sqrt(wtd.var(x$Q17, x$weight))/sqrt(length(x$Q17)),"org"=i,"type"="appr"))
}
d = mass
for (i in c(1,2)) {
x = d[which(d$organization_var==i),]
sum_d = rbind(sum_d,data.frame("mean"=wtd.mean(x$Q17, x$weight),"sd"=sqrt(wtd.var(x$Q17, x$weight)),"se"=sqrt(wtd.var(x$Q17, x$weight))/sqrt(length(x$Q17)),"org"=i,"type"="mass"))
}
p= ggplot(sum_d, aes(x=type, y=mean, fill=factor(sum_d$org))) +
geom_bar(stat="identity", color="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-1.96*se, ymax=mean+1.96*se), width=.2, position=position_dodge(.9)) +  labs(x = "Respondent Groups") + scale_x_discrete(labels = c("Preservationists","Resource Users","Mass Public"))+ coord_cartesian(ylim=c(3,7)) + scale_fill_grey(start = 0.4, end = .9, name = "NGO", labels = c("WWF", "ENV"))+  theme_bw()
p
### Figure 2 (b): average responses based on frames
sum_d = data.frame()
d = preservationists
for (i in c(1,2,3)) {
x = d[which(d$frame_var==i),]
sum_d = rbind(sum_d,data.frame("mean"=wtd.mean(x$Q17, x$weight),"sd"=sqrt(wtd.var(x$Q17, x$weight)),"se"=sqrt(wtd.var(x$Q17, x$weight))/sqrt(length(x$Q17)),"frame"=i,"type"="pres"))
}
d = appropriators
for (i in c(1,2,3)) {
x = d[which(d$frame_var==i),]
sum_d = rbind(sum_d,data.frame("mean"=wtd.mean(x$Q17, x$weight),"sd"=sqrt(wtd.var(x$Q17, x$weight)),"se"=sqrt(wtd.var(x$Q17, x$weight))/sqrt(length(x$Q17)),"frame"=i,"type"="appr"))
}
d = mass
for (i in c(1,2,3)) {
x = d[which(d$frame_var==i),]
sum_d = rbind(sum_d,data.frame("mean"=wtd.mean(x$Q17, x$weight),"sd"=sqrt(wtd.var(x$Q17, x$weight)),"se"=sqrt(wtd.var(x$Q17, x$weight))/sqrt(length(x$Q17)),"frame"=i,"type"="mass"))
}
p= ggplot(sum_d, aes(x=type, y=mean, fill= as.factor(frame) )) +
geom_bar(stat="identity", color="black",
position=position_dodge()) +
geom_errorbar(aes(ymin=mean-1.96*se, ymax=mean+1.96*se), width=.2, position=position_dodge(.9)) +  labs(x = "Respondent Groups") + scale_x_discrete(labels = c("Preservationists","Resource Users","Mass Public")) + coord_cartesian(ylim=c(3,7)) + scale_fill_grey(start = 0.4, end = .9, name = "Frame", labels = c("Harm-and-threats", "Sustainable use","Pandemic"))+  theme_bw()
p
library(ggplot2)
library(plyr)
library(reshape)
library(weights)
rm(list=ls())
d = read.csv("clean_data.csv", header = T)
d$frame_var = as.factor(d$frame_var)# 1=harm-and-threats, 2=sustainability, 3=pandemic frame
d$organization_var = as.factor(d$organization_var)# 1=WWF, 2=ENV (Vietnam)
### Subgroup
# Resource Users (earlier version of the paper used the term "appropriators")
appropriators = rbind(d[which(d$Q34=="A few times a week"),], d[which(d$Q34=="Everyday"),])
# Preservationists
preservationists = d[which(d$Q28=="Very important"&d$Q30=="Very important"&d$Q34!="A few times a week"&d$Q34!="Everyday"),]
# Mass Public
x=c(appropriators$id,preservationists$id)
x=(unique(x))
mass = d
for (i in 1:length(x)) {
mass = mass[-which(mass$id==x[i]),]
}
### Regression models
m1_1 = lm(Q17~organization_var+frame_var+age+Q2+ relevel(Q6, ref="Less than high school degree") + relevel(Q8, ref="Not proud at all") + relevel(Q10, ref="Urban")+relevel(Q12, ref="Urban") + relevel(Q14, ref="Neither"),weights = weight, mass)
m1_2 = lm(Q17~frame_var+organization_var, weights = weight,mass)
m2_1 = lm(Q17~organization_var+frame_var+age+Q2+ relevel(Q6, ref="Less than high school degree") + relevel(Q8, ref="Not proud at all") + relevel(Q10, ref="Urban")+relevel(Q12, ref="Urban") + relevel(Q14, ref="Neither"), weights = weight, preservationists)
m2_2 = lm(Q17~frame_var+organization_var, weights = weight, preservationists)
m3_1 = lm(Q17~organization_var+frame_var+age+Q2+ relevel(Q6, ref="Less than high school degree") + relevel(Q8, ref="Not proud at all") + relevel(Q10, ref="Urban")+relevel(Q12, ref="Urban") + relevel(Q14, ref="Neither"), weights = weight, appropriators)
m3_2 = lm(Q17~frame_var+organization_var, weights = weight, appropriators)
### Visualization
m2_1Frame = data.frame(Variable = rownames(summary(m2_1)$coef)[2:4],
Coefficient = summary(m2_1)$coef[2:4, 1],
SE = summary(m2_1)$coef[2:4, 2],
modelName = "Preservationists")
m3_1Frame = data.frame(Variable = rownames(summary(m3_1)$coef)[2:4],
Coefficient = summary(m3_1)$coef[2:4, 1],
SE = summary(m3_1)$coef[2:4, 2],
modelName = "Resource Users")
m1_1Frame = data.frame(Variable = rownames(summary(m1_1)$coef)[2:4],
Coefficient = summary(m1_1)$coef[2:4, 1],
SE = summary(m1_1)$coef[2:4, 2],
modelName = "Mass Public")
allModelFrame = data.frame(rbind(m2_1Frame,m3_1Frame,m1_1Frame))
allModelFrame$Variable =  revalue(allModelFrame$Variable, c("organization_var2"="ENV","frame_var2"="Sustainable use frame", "frame_var3"="Pandemic frame"))
# Specify the width of your confidence intervals
interval1 = -qnorm((1-0.9)/2)  # 90% multiplier
interval2 = -qnorm((1-0.95)/2)  # 95% multiplier
# Plot
allModelFrame$Variable = factor(allModelFrame$Variable, levels = c("ENV","Sustainable use frame","Pandemic frame"), order =TRUE)
zp1 = ggplot(allModelFrame, aes(colour = modelName))
zp1 = zp1 + geom_hline(yintercept = 0, colour = gray(1/2), lty = 2)
zp1 = zp1 + geom_linerange(aes(x = Variable,
ymin = Coefficient - SE*interval1,
ymax = Coefficient + SE*interval1),
lwd = 1,
position = position_dodge(width = 1/2))
zp1 = zp1 + geom_pointrange(aes(x = Variable, y = Coefficient,
ymin = Coefficient - SE*interval2,
ymax = Coefficient + SE*interval2),
lwd = 1/2,
position = position_dodge(width = 1/2),
shape = 16)
zp1 = zp1 + theme_bw() + scale_colour_grey(start = .1, end = .6, name = "Group", labels = c("Preservationists","Resource Users","Mass Public")) + theme(axis.text.x = element_text(angle = 45,  vjust = 1, hjust=1))
print(zp1)
